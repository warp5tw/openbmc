From 84a55072363ecbbc344b446217e3caa73dde7803 Mon Sep 17 00:00:00 2001
From: kfting <kfting@nuvoton.com>
Date: Mon, 1 Jul 2019 17:05:06 +0800
Subject: [PATCH] Add user password update support for LDAP

1. Bypass OpenBMC's default behavior

Signed-off-by: kfting <kfting@nuvoton.com>
---
 app/common/services/api-utils.js | 11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)

diff --git a/app/common/services/api-utils.js b/app/common/services/api-utils.js
index 840db8e..20c2f97 100644
--- a/app/common/services/api-utils.js
+++ b/app/common/services/api-utils.js
@@ -668,11 +668,14 @@ window.angular && (function(angular) {
             function setUserPassword(user, passwd) {
               return $http({
                        method: 'POST',
-                       url: DataService.getHost() +
-                           '/xyz/openbmc_project/user/' + user +
-                           '/action/SetPassword',
+                      //Bypass OpenBMC's default behavior
+                      //url: DataService.getHost() +
+                      //    '/xyz/openbmc_project/user/' + user +
+                      //    '/action/SetPassword',
+                       url: DataService.getHost() + '/setpassword',
                        withCredentials: true,
-                       data: JSON.stringify({'data': [passwd]}),
+                       //data: JSON.stringify({'data': [passwd]}),
+                       data: JSON.stringify({'data': [user, newPassword]}),
                        responseType: 'arraybuffer'
                      })
                   .then(function(response) {
-- 
2.17.1

